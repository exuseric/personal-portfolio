@import "tailwindcss";
@import "./tokens.css" layer(global);
@import "./theme.css";
@import "./animations.css";
@import "./form-elements.css";
@import "./button.css";

@theme inline {
    /* Brand */
    --color-brand: var(--text-brand);
    --color-on-brand: var(--text-on-brand);
    --color-on-error: var(--text-on-error);
    --color-on-success: var(--text-on-success);
    --color-on-warning: var(--text-on-warning);

    /* Text */
    --color-foreground: var(--text-primary);
    --color-secondary: var(--text-secondary);
    --color-tertiary: var(--text-tertiary);
    --color-error: var(--text-error-strong);
    --color-success: var(--text-success-strong);
    --color-disabled: var(--text-disabled);
    --color-placeholder: var(--text-placeholder);
    --color-on-dark: var(--text-on-dark);

    /* Surfaces */
    --color-surface-background: var(--surface-background);
    --color-surface-card: var(--surface-card);
    --color-surface-subtle: var(--surface-background-alt);
    --color-surface-overlay: var(--surface-scrim);

    /* Brand Surfaces */
    --color-surface-brand: var(--surface-brand-default);
    --color-surface-brand-subtle: var(--surface-brand-subtle);
    --color-surface-brand-hover: var(--surface-brand-hover);
    --color-surface-brand-active: var(--surface-brand-active);
    --color-surface-brand-disabled: var(--surface-brand-disabled);

    /* Semantic Surfaces */
    --color-surface-error: var(--surface-error);
    --color-surface-error-emphasis: var(--surface-error-emphasis);
    --color-surface-warning: var(--surface-warning);
    --color-surface-success: var(--surface-success);
    --color-surface-info: var(--surface-info);

    /* Borders */
    --color-border-default: var(--border-default);
    --color-border-subtle: var(--border-subtle);
    --color-border-brand: var(--border-brand);
    --color-border-error: var(--border-error);
    --color-border-warning: var(--border-warning);
    --color-border-success: var(--border-success);
    --color-border-info: var(--border-info);

    --spacing-container-block: calc(var(--spacing) * 24);
    --spacing-safe-bottom: calc(1em + env(safe-area-inset-bottom));
    --spacing-safe-top: calc(1em + env(safe-area-inset-top));
}

/*
@import "./reset.css" layer(framework);
@import "./navigation.css" layer(components);*/
@layer global {
    :root {
        /* Layout */
        --content-width: min(100% - 2rem, 47rem);
        /*800px*/
        --site-width: min(100% - 2rem, 75rem);
        /*1200px*/
    }

    html,
    body {
        scroll-behavior: smooth;
        interpolate-size: allow-keywords;
        overscroll-behavior: none;
        -webkit-font-smoothing: antialiased;
        text-wrap: pretty;
        transition:
            background-color var(--transition-anticipate-fast),
            color var(--transition-anticipate-medium);
    }

    body {
        @apply relative isolate z-1;
    }

    @supports (scrollbar-width: auto) {
        html {
            scrollbar-color: var(--scrollbar-color-thumb) var(--scrollbar-color-track);
            scrollbar-width: var(--scrollbar-width);
        }
    }

    @supports selector(::-webkit-scrollbar) {
        html::-webkit-scrollbar-thumb {
            background: var(--scrollbar-color-thumb);
        }
        html::-webkit-scrollbar-track {
            background: var(--scrollbar-color-track);
        }
        html::-webkit-scrollbar {
            max-width: var(--scrollbar-width-legacy);
            max-height: var(--scrollbar-width-legacy);
        }
    }

    /* Typography */
    h1,
    h2,
    h3,
    h4,
    h5 {
        margin-bottom: var(--size-4);
        font-weight: 400;
        orphans: 1;
        text-wrap: balance;
    }
    h2,
    .h2 {
        @apply text-3xl leading-tight;
    }

    h3,
    .h3 {
        @apply text-xl leading-tight;
    }

    h4,
    .h4 {
        @apply text-lg leading-normal;
    }

    h5,
    .h5 {
        @apply text-base leading-normal;
    }

    h2,
    .h2,
    h3,
    .h3,
    h4,
    .h4,
    h5,
    .h5 {
        max-width: 40ch;
    }

    small {
        @apply text-sm text-secondary;
    }

    p {
        @apply max-w-prose m-0;
    }

    img {
        max-width: 100%;
        height: auto;
        vertical-align: middle;
        font-style: italic;
        background-repeat: no-repeat;
        background-size: cover;
        shape-margin: 1rem;
    }
}

@utility glass {
    @apply text-foreground bg-surface-subtle border border-border-subtle;

    @supports (backdrop-filter: blur(30px)) {
        backdrop-filter: blur(30px);
        background-color: oklch(from var(--color-surface-subtle) l c h / 0.6);
        border-color: oklch(from var(--color-surface-subtle) l c h / 0.6);
    }
}

@layer utilities {
    .layout-grid {
        --padding-inline: 1rem;
        --content-max-width: var(--site-width);
        --breakout-max-width: calc(var(--site-width) + 6rem);
        --breakout-size: calc((var(--breakout-max-width) - var(--content-max-width)) / 2);

        display: grid;
        grid-template-columns:
            [full-width-start] minmax(var(--padding-inline), 1fr) [breakout-start] minmax(0, var(--breakout-size))
            [content-start] min(100% - (var(--padding-inline) * 2), var(--content-max-width)) [content-end] minmax(
                0,
                var(--breakout-size)
            )
            [breakout-end] minmax(var(--padding-inline), 1fr) [full-width-end];
        grid-auto-rows: max-content;
        width: 100%;
    }

    @media (min-width: 768px) and (max-width: 1200px) {
        .layout-grid {
            --content-max-width: var(--content-width);
        }
    }

    .layout-grid > :not(.breakout, .full-width) {
        grid-column: content;
    }

    .layout-grid > .breakout {
        grid-column: breakout;
    }

    .layout-grid > .full-width {
        grid-column: full-width;
    }

    .page-wrapper {
        @apply flex flex-col gap-y-0 min-h-screen items-center;
    }

    [data-offscreen] {
        content-visibility: auto;
        contain-intrinsic-size: auto 31.25rem;
    }

    @supports (corner-shape: squircle) {
        .button,
        .squircle {
            corner-shape: squircle;
        }
    }

    .about-content ul {
        @apply list-disc pl-8;
    }
}

@layer animations {
    ::view-transition-old(root) {
        animation:
            90ms cubic-bezier(0.4, 0, 1, 1) both fade-out,
            300ms cubic-bezier(0.4, 0, 0.2, 1) both slide-to-left;
    }

    ::view-transition-new(root) {
        animation:
            210ms cubic-bezier(0, 0, 0.2, 1) 90ms both fade-in,
            300ms cubic-bezier(0.4, 0, 0.2, 1) both slide-from-right;
    }
}

@scope (.faq) {
    summary {
        @apply flex flex-row flex-wrap justify-between items-center text-foreground cursor-pointer mb-2;
        h3 {
            @apply my-0 max-w-[25ch];
        }
        .icon {
            @apply text-current size-5;
        }
    }
    .details-content-inner {
        @apply flex flex-col gap-y-4 pt-8 min-h-0;
    }
    details {
        --_radius: var(--radius-lg);
        @apply overflow-hidden border border-border-default p-4;
    }

    /* Icon rotation animation */
    details[open] summary .icon {
        animation: iconRotate var(--transition-fast) forwards;
    }
    details:not([open]) summary .icon {
        animation: iconRotateReverse var(--transition-fast) forwards;
    }

    /* Details expansion animation */
    details[open] {
        animation: detailsExpand var(--transition-elastic-slow) forwards;
        @apply rounded-lg my-4 border-border-brand bg-surface-background;
    }

    details[open] .details-content-wrapper {
        animation: contentReveal var(--transition-medium) forwards;
    }

    details:not([open]) .details-content-wrapper {
        animation: contentHide var(--transition-medium) forwards;
        @apply grid overflow-hidden;
    }

    details:has(+ details[open]),
    details:last-child {
        @apply rounded-b-lg;
    }
    details[open] + details,
    details:first-child {
        @apply rounded-t-lg;
    }
    details:not(:last-child, details[open], :has(+ details[open])) {
        @apply border-b-0;
    }

    @media (min-width: 768px) {
        summary h3 {
            @apply max-w-prose;
        }
    }

    @keyframes iconRotate {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(180deg);
        }
    }

    @keyframes iconRotateReverse {
        from {
            transform: rotate(180deg);
        }
        to {
            transform: rotate(0deg);
        }
    }

    @keyframes detailsExpand {
        0% {
            border-radius: 0;
            margin-block: 0;
        }
        100% {
            border-radius: var(--_radius);
            margin-block: 1rem;
        }
    }

    @keyframes contentReveal {
        from {
            grid-template-rows: 0fr;
            opacity: 0;
        }
        to {
            grid-template-rows: 1fr;
            opacity: 1;
        }
    }

    @keyframes contentHide {
        from {
            grid-template-rows: 1fr;
            opacity: 1;
        }
        to {
            grid-template-rows: 0fr;
            opacity: 0;
        }
    }
}

#desktopNav,
#mobileNav {
    scroll-target-group: auto;

    a {
        transition: all var(--transition-micro-fast);

        &:target-current {
            @apply text-brand;
        }
    }
}
